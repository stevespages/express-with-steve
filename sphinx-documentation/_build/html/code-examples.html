
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Code Examples &#8212; Learning Express 0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notes" href="notes.html" />
    <link rel="prev" title="Deploy Using Github and Heroku" href="deployment.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><a class="reference internal" href="index.html"><span class="doc">Home</span></a></p>
<div class="section" id="code-examples">
<h1>Code Examples<a class="headerlink" href="#code-examples" title="Permalink to this headline">¶</a></h1>
<p>The code examples each have a link to see what the code does in a browser. There is also a link to the code itself hosted at github. There are also links to other relevant files such as javascript and pug files for some of the examples.</p>
<p>You may also want to see the <a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/app.js">app.js</a> file.</p>
<p>The full code for <a class="reference external" href="https://github.com/stevespages/express-with-steve">express-with-steve</a> is also available on github.</p>
<div class="section" id="different-route">
<h2>different-route<a class="headerlink" href="#different-route" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./different-route">different-route</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/different-route.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/different-route.js</a></p>
<p>This shows a minimal implementation of a route using the express.Router class</p>
</div>
<div class="section" id="env-var">
<h2>env-var<a class="headerlink" href="#env-var" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./env-var">env-var</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/env-var.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/env-var.js</a></p>
<p>This shows how environment variables can be supplied to a node express app and used from within the app. This can be preferable to hardcoding them and risking them being exposed (for example on git) to malicious users. If you follow the web link for this code example you will only see something in the browser if the server was supplied with an environment variable called MY_ENV_VAR when it was started. Follow the git link above to see how this can be done.</p>
</div>
<div class="section" id="mailer">
<h2>mailer<a class="headerlink" href="#mailer" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./mailer">mailer</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/mailer.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/mailer.js</a></p>
<p>npm modules: mailer</p>
<p>This demonstrates use of the mailer module to send an email. A password is required for the email account that the email is sent from. It would be insecure to hardcode this in the programme and then store it in a public repository such as the one I have on github. So I set an environment variable, GMAIL_PASSWORD, when I start the server and access this from within node using process.env.GMAIL_PASSWORD. I am unlikely to start the Heroku (production) server with the required environment variable (although I might!) so it probably won’t send an email. Run locally I may start the server with the environment variable and so it should work then.</p>
</div>
<div class="section" id="javascript-and-jquery">
<h2>javascript-and-jquery<a class="headerlink" href="#javascript-and-jquery" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./javascript-and-jquery">javascript-and-jquery</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/javascript-and-jquery.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/javascript-and-jquery.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/javascript-and-jquery.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/javascript-and-jquery.pug</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/javascript.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/javascript.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/jquery.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/jquery.js</a></p>
<p>This demonstrates importing a javascript and a jquery file into a pug file. Express application generator generates a public directory for serving static files. It puts three directories in there one of which is called javascripts. In this code example we put a file called javascript.js in this javascripts directory. The javascript.js file has a function called myFunction() in it which changes the text in a paragraph when a button is clicked. We also have a file called jquery.js in the /public/javascripts directory. This is also linked to from the pug script. This has some jquery code in it which causes some text (The page just loaded) to be displayed once the page has loaded.</p>
<p>We could have installed jquery with npm. The jquery-3.4.1.js file would then be in the node_modules directory and we would have to make sure that the .pug files which used it linked correctly to it instead of express.static to link to public/javascripts/jquery-3.4.1.js.</p>
<p>Another option is to link from the .pug file to jquery on a CDN. It may download faster to the browser from the CDN than from your own server. Also jquery might be cached on the browser already if a site has been visited which links to jquery hosted on the same CDN.</p>
<p>In an HTML file we could place the following code (immediately before the closing body tag is a good place):</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://code.jquery.com/jquery-3.0.0.min.js&quot;</span> <span class="n">integrity</span><span class="o">=</span>
<span class="s2">&quot;blahblahblah&quot;</span> <span class="n">crossorigin</span><span class="o">=</span><span class="s2">&quot;anonymous&quot;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="n">window</span><span class="o">.</span><span class="n">jQuery</span> <span class="o">||</span> <span class="n">document</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;script src=</span>
<span class="s2">&quot;jquery-3.0.0.min.js&quot;</span><span class="o">&gt;&lt;</span>\<span class="o">/</span><span class="n">script</span><span class="s1">&#39;);&lt;/script&gt;</span>
</pre></div>
</div>
<p>If we were using PUG we would have to write the HTML above differenctly and / or link to an external javascript file with the code in. Now jquery would use the CDN but if offline it would use the version hosted with the website.</p>
<p>In our public/javascript/jquery.js file we have the following code:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>$(&quot;document&quot;).ready(function() {
  $(&quot;#content&quot;).append(&quot;&lt;p&gt;The page just loaded&lt;/p&gt;&quot;);
})
</pre></div>
</div>
<p>A newer way to do the same thing is:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>$(function() {
  &quot;use strict&quot;
  // code
})
</pre></div>
</div>
</div>
<div class="section" id="jquery-counter">
<h2>jquery-counter<a class="headerlink" href="#jquery-counter" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./jquery-counter">jquery-counter</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/jquery-counter.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/jquery-counter.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/jquery-counter.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/jquery-counter.pug</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/jquery-counter.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/public/javascripts/jquery-counter.js</a></p>
</div>
<div class="section" id="multer">
<h2>multer<a class="headerlink" href="#multer" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./multer">multer</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/multer.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/multer.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/multer.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/multer.pug</a></p>
<p>npm modules: multer</p>
<p>A directory called <cite>multer-uploads</cite> was created in the <cite>public</cite> directory for uploads to be stored in.</p>
</div>
<div class="section" id="multer-2-files">
<h2>multer-2-files<a class="headerlink" href="#multer-2-files" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./multer-2-files">multer-2-files</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/multer-2-files.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/multer-2-files.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/multer-2-files.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/multer-2-files.pug</a></p>
<p>npm modules: multer</p>
<p>A directory called <cite>multer-uploads</cite> was created in the <cite>public</cite> directory for uploads to be stored in.</p>
</div>
<div class="section" id="users">
<h2>users<a class="headerlink" href="#users" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="./login-demo-page">login-demo-page</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/login-demo-page.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/login-demo-page.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/users.js">https://raw.githubusercontent.com/stevespages/express-with-steve/master/routes/users.js</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/login-demo-page.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/login-demo-page.pug</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/users/login.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/users/login.pug</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/users/register.pug">https://raw.githubusercontent.com/stevespages/express-with-steve/master/views/users/register.pug</a></p>
<p>node modules: bcrypt express-session sqlite3</p>
<p>This section of Code Examples illustrates the implementation of a login system for a website. A typical page (it could be the home page or any other page of a web site) which is here called login-demo-page has been used to show how a login and a register link can be displayed if the page is being viewed by a non logged in user but these links are not displayed when a user is logged in. Also when a user is logged in their name and / or other personal details about them can be displayed as well as a logout link and a change password link.</p>
<p>The routes/users.js file has get and post routes for registration, login and forgot password and change password?. The views (pug files) for the get routes are in the views/users directory. There is also a user/user-id route which is password protected and therefore only able to be viewed if that user is logged in.</p>
<p>A get request to users/register displays a form with fields for name, email and password. On submitting the forma post request with the entered data is sent to users/register where it is entered into a database along with an automatically generated id for the user. The schema of the sqlite3 database is shown here:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>steve@Dell:~/Desktop/express-with-steve$ sqlite3 sqlite3.db
SQLite version 3.22.0 2018-01-22 18:45:57
Enter &quot;.help&quot; for usage hints.
sqlite&gt; .schema
CREATE TABLE users (
id INTEGER PRIMARY KEY,
email TEXT,
password TEXT,
name TEXT
);
sqlite&gt;
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Code Examples</a><ul>
<li><a class="reference internal" href="#different-route">different-route</a></li>
<li><a class="reference internal" href="#env-var">env-var</a></li>
<li><a class="reference internal" href="#mailer">mailer</a></li>
<li><a class="reference internal" href="#javascript-and-jquery">javascript-and-jquery</a></li>
<li><a class="reference internal" href="#jquery-counter">jquery-counter</a></li>
<li><a class="reference internal" href="#multer">multer</a></li>
<li><a class="reference internal" href="#multer-2-files">multer-2-files</a></li>
<li><a class="reference internal" href="#users">users</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="deployment.html" title="previous chapter">Deploy Using Github and Heroku</a></li>
      <li>Next: <a href="notes.html" title="next chapter">Notes</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/code-examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Steve Greig.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/code-examples.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>